<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Publish-ProvMasterVMImage - Citrix PowerShell SDK Documentation</title>
  

  <link rel="shortcut icon" href="
https://www.citrix.com/etc/designs/citrix/icon-favicon.png">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/base.css">
  <link rel="stylesheet" href="../../css/highlight.css">
  <link rel="stylesheet" href="../../css/override.css" type="text/css" />
  <link rel="stylesheet" href="../../css/font-awesome.css" type="text/css" />

  
  <script>
    // Current page data
    var mkdocs_page_name = "Publish-ProvMasterVMImage";
    var mkdocs_page_input_path = "MachineCreation/Publish-ProvMasterVMImage.md";
    var mkdocs_page_url = "/MachineCreation/Publish-ProvMasterVMImage/";
  </script>
  
  <script src="../../js/jquery-1.10.2.min.js"></script>
  <script src="../../js/bootstrap-3.0.3.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>
  <script src="../../js/base.js"></script>
  <script src="../../js/custom.js"></script>
  <script src="../../js/nav.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document" data-spy="scroll" data-target=".bs-sidebar">

	<div class="header-top">
		<div class="header-top-left">
			<a href="http://citrix.github.io" class="logo-position"><img height="60" src="https://thumbnail-ec2.sharefile.com/thumbnail.aspx?encparams=ypL2J0l-In6gqXJ7yeyKP8A1rqwKMH-C8-nfkJcHJNIN7Y0yZiJsYOcUe-uc0YeZzWLQSFSd1FnuMHPa30XSSINHuGOA8nvvnBT5WmjGlKvd5mxJ4IfT7iTVyHELwhWQiNCznPCiIFyhkA78uKX77PlU2iyhM4YdRM1NKabBe-4wXuiFJsbtAxyJ2UukO_E2ZSf1W3l75Dw8G0zflVkT-EFqyx1zSGId0qzLjm6nzJ8dA9zo-1AJzUisdzmGMzHOq_LMsOWyaalvmcWvCkl-q10GBSbfekfTIFW9LpZNYjkLNSnK8rcwNjWVr_jYayrGjIj2e5dDIMiDj3NRvW51AvHRjxYH9xRRRtY$" target="_blank" class="logo-citrix"><span style="color:#fff;font-size: 20px;position: relative;top:4px;left: 5px">SDK Reference</span></a>
		</div>
		<div class="header-top-right">
			<ul>
			<!--	<li class="list-inline home"><a href="../..">HOME</a></li>
				<li class="list-inline support"><a href="http://support.citrix.com">SUPPORT</a></li>-->
				<form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
            <li class="list-inline support"><input name="q" id="txtName" type="text" placeholder="Search SDKs"
            class="searchdocs">
<a class="fa fa-search errspan"></a></li>
</form>
				<!--<li class="list-inline"><a href="http://citrix.com/download">DOWNLOADS</a></li>-->
			</ul>

		</div>
	</div>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
	<i class="fa fa-search"></i>
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
			<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#syntax">Syntax</a></li>
        
    
        <li class="main "><a href="#detailed-description">Detailed Description</a></li>
        
    
        <li class="main "><a href="#related-commands">Related Commands</a></li>
        
    
        <li class="main "><a href="#parameters">Parameters</a></li>
        
    
        <li class="main "><a href="#input-type">Input Type</a></li>
        
    
        <li class="main "><a href="#return-values">Return Values</a></li>
        
            <li><a href="#systemguid-when-runasynchronously-is-specified-this-identifier-is-returned-to-provide-the-task-identifiersystemmanagementautomationpscustomobject-this-object-provides-details-of-the-task-run-and-contains-the-following-information-taskid-the-identifier-for-the-task-that-was-performed-active-indicates-whether-the-task-is-still-processing-or-is-complete-host-the-name-of-the-host-on-which-the-task-is-running-or-was-run-datestarted-the-date-and-time-that-the-task-was-initiated-type-the-type-of-the-task-for-new-provisioning-scheme-tasks-this-is-always-newprovisioningscheme-metadata-the-list-of-metadata-stored-against-the-task-for-new-tasks-this-will-be-empty-until-metadata-is-added-workflowstatus-indicates-the-status-of-the-workflow-that-is-being-used-to-process-the-task-provisioningschemename-the-name-of-the-provisioning-scheme-that-the-task-was-for-provisioningschemeuid-the-unique-identifier-of-the-provisioning-scheme-that-the-task-was-for-masterimage-the-path-in-the-hosting-unit-provider-of-the-virtual-machine-snapshot-or-vm-template-that-was-used-as-the-master-image-for-the-task-identitypoolname-the-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-identitypooluid-the-unique-identifier-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunitname-the-name-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunituid-the-unique-identifier-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-taskstate-the-state-of-the-task-this-can-be-any-of-the-following-processing-indicates-that-the-task-has-just-begun-and-has-not-done-anything-yet-locatingresources-indicates-that-the-workflow-is-locating-resources-from-other-services-hostingunitnotfound-indicates-that-the-task-failed-because-the-required-hosting-unit-could-not-be-located-virtualmachinesnapshotnotfound-indicates-that-the-task-failed-because-the-required-snapshot-or-vm-template-could-not-be-located-consolidatingmasterimage-indicates-that-the-task-is-consolidating-the-master-image-replicatingconsolidatedimagetoallstorage-indicates-that-the-task-is-replicating-the-consolidated-master-image-storingprovisioningscheme-indicates-that-the-task-is-storing-the-provisioning-scheme-data-to-the-database-finished-indicates-that-the-task-has-completed-with-no-errors-provisioningschemealreadyexists-indicates-that-the-task-failed-because-a-provisioning-scheme-with-the-same-name-already-exists-identitypoolnotfound-indicates-that-the-task-failed-because-the-identity-pool-specified-could-not-be-found-mastervmimageisnotpartofprovisioningschemehostingunit-indicates-that-the-hosting-unit-that-the-master-image-originated-from-is-not-the-same-hosting-unit-that-the-provisioning-scheme-is-defined-to-use-mastervmimageisnotasnapshot-indicates-that-the-task-failed-because-the-master-vm-image-path-does-not-refer-to-a-snapshot-or-a-vm-template-item-provisioningschemenotfound-could-not-find-a-provisioning-scheme-with-the-specified-name-taskalreadyrunningforprovisioningscheme-a-task-for-a-provisioning-scheme-with-the-same-name-is-already-running-invalidmastervmconfiguration-the-vm-snapshot-or-vm-template-specified-as-the-master-had-an-invalid-configuration-invalidmastervmstate-the-vm-snapshot-or-vm-template-specified-as-the-master-is-currently-in-an-invalid-state-insufficientresources-indicates-that-the-task-failed-because-the-hypervisor-did-not-have-enough-resources-to-complete-the-task-storagenotfound-indicates-that-no-associated-storage-was-found-in-the-hosting-unit-canceled-indicates-that-the-task-was-stopped-by-user-intervention-using-stop-provtask-taskstateinformation-holds-string-data-providing-more-details-about-the-current-task-state-taskprogress-the-progress-of-the-task-0-100">System.Guid    When "RunAsynchronously" is specified, this identifier is returned to provide the task identifier.System.Management.Automation.PSCustomObject    This object provides details of the task run and contains the following information:        TaskId             The identifier for the task that was performed.        Active             Indicates whether the task is still processing or is complete.        Host             The name of the host on which the task is running or was run.        DateStarted             The date and time that the task was initiated.        Type             The type of the task.  For new provisioning scheme tasks this is always "NewProvisioningScheme".        Metadata             The list of metadata stored against the task.  For new tasks this will be empty until metadata is added.        WorkflowStatus             Indicates the status of the workflow that is being used to process the task.        ProvisioningSchemeName             The name of the provisioning scheme that the task was for.        ProvisioningSchemeUid             The unique identifier of the provisioning scheme that the task was for.        MasterImage             The path (in the hosting unit provider) of the virtual machine snapshot or VM template that was used as the master image for the task.        IdentityPoolName             The name of the identity pool (from the ADIdentity PowerShell snap-in) that the new provisioning scheme will use.        IdentityPoolUid             The unique identifier name of the identity pool (from the ADIdentity PowerShell snap-in) that the new provisioning scheme will use.        HostingUnitName             The name of the hosting unit (from the Hosting Unit PowerShell snap-in) that the new provisioning scheme will use.        HostingUnitUid            The unique identifier of the hosting unit (from the Hosting Unit PowerShell snap-in) that the new provisioning scheme will use.        TaskState             The state of the task.  This can be any of the following:                Processing                    Indicates that the task has just begun and has not done anything yet.                LocatingResources,                    Indicates that the workflow is locating resources from other services.                HostingUnitNotFound                    Indicates that the task failed because the required hosting unit could not be located.                VirtualMachineSnapshotNotFound                    Indicates that the task failed because the required snapshot or VM template could not be located.                ConsolidatingMasterImage                    Indicates that the task is consolidating the master image.                ReplicatingConsolidatedImageToAllStorage                    Indicates that the task is replicating the consolidated master image.                StoringProvisioningScheme                    Indicates that the task is storing the provisioning scheme data to the database.                Finished                    Indicates that the task has completed with no errors.                ProvisioningSchemeAlreadyExists                    Indicates that the task failed because a provisioning scheme with the same name already exists.                IdentityPoolNotFound                    Indicates that the task failed because the identity pool specified could not be found.                MasterVMImageIsNotPartOfProvisioningSchemeHostingUnit,                    Indicates that the hosting unit that the master image originated from is not the same hosting unit that the provisioning scheme is defined to use.                MasterVmImageIsNotASnapshot                    Indicates that the task failed because the master VM image path does not refer to a snapshot or a VM template item.                ProvisioningSchemeNotFound                    Could not find a provisioning scheme with the specified name.                TaskAlreadyRunningForProvisioningScheme                    A task for a provisioning scheme with the same name is already running.                InvalidMasterVMConfiguration                    The VM snapshot or VM template specified as the master had an invalid configuration.                InvalidMasterVMState                    The VM snapshot or VM template specified as the master is currently in an invalid state.                InsufficientResources                    Indicates that the task failed because the hypervisor did not have enough resources to complete the task.                StorageNotFound                    Indicates that no associated storage was found in the hosting unit.                Canceled                    Indicates that the task was stopped by user intervention (using Stop-ProvTask).        TaskStateInformation             Holds string data providing more details about the current task state.        TaskProgress            The progress of the task 0-100%.</a></li>
        
    
        <li class="main "><a href="#examples">Examples</a></li>
        
            <li><a href="#example-1">EXAMPLE 1</a></li>
        
    
    </ul>
</div>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      


      
      <div class="wy-nav-content">
        <div class="rst-content">
         <!-- <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>MachineCreation &raquo;</li>
        
      
    
    <li>Publish-ProvMasterVMImage</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div> -->
          <div role="main">
            <div class="section">
             
                <p>ï»¿# Publish-ProvMasterVMImage</p>
<p>Update the master image associated with the provisioning scheme.</p>
<h2 id="syntax"><a class="toclink" href="#syntax">Syntax</a></h2>
<div class="codehilite"><pre><span></span>Publish-ProvMasterVMImage [-ProvisioningSchemeName] &lt;String&gt; -MasterImageVM &lt;String&gt; [-VhdTemplateSource &lt;String&gt;] [-VhdResultDestination &lt;String&gt;] [-AppScanResultsFile &lt;String&gt;] [-FunctionalLevel &lt;String&gt;] [-RunAsynchronously] [-PurgeJobOnSuccess] [-DoNotStoreOldImage] [-LoggingId &lt;Guid&gt;] [-AdminAddress &lt;String&gt;] [&lt;CommonParameters&gt;]

Publish-ProvMasterVMImage -ProvisioningSchemeName &lt;String&gt; [-DoNotStoreOldImage] [-LoggingId &lt;Guid&gt;] [-AdminAddress &lt;String&gt;] [&lt;CommonParameters&gt;]

Publish-ProvMasterVMImage -ProvisioningSchemeUid &lt;Guid&gt; -MasterImageVM &lt;String&gt; [-VhdTemplateSource &lt;String&gt;] [-VhdResultDestination &lt;String&gt;] [-AppScanResultsFile &lt;String&gt;] [-FunctionalLevel &lt;String&gt;] [-RunAsynchronously] [-PurgeJobOnSuccess] [-DoNotStoreOldImage] [-LoggingId &lt;Guid&gt;] [-AdminAddress &lt;String&gt;] [&lt;CommonParameters&gt;]

Publish-ProvMasterVMImage -ProvisioningSchemeUid &lt;Guid&gt; [-DoNotStoreOldImage] [-LoggingId &lt;Guid&gt;] [-AdminAddress &lt;String&gt;] [&lt;CommonParameters&gt;]
</pre></div>


<h2 id="detailed-description"><a class="toclink" href="#detailed-description">Detailed Description</a></h2>
<p>Provides the ability to update the hard disk image used to provision virtual machines. If the provisioning scheme is a 'CleanOnBoot' type, then the next time that virtual machines are started, their hard disks are updated to this new image.  Regardless of the 'CleanOnBoot' type, all new virtual machines created after this command will use this new hard disk image.</p>
<p>A background task will be created to remove the old hard disk copies.  You can locate and monitor this task using the Get-ProvTask cmdlet.</p>
<p>A snapshot or VM template is used rather than a VM, so that the content of the hard disk for the provisioning scheme can be easily determined.</p>
<p>As the snapshot or VM template are specified using a path into the Citrix Host Service PowerShell Provider, the Citrix Host Service PowerShell snap-in must also be loaded for this cmdlet to be used.</p>
<p>The previous hard disk image path is stored into the history (see Get-ProvSchemeMasterVMImageHistory).  The data stored in the history allows for a rollback to be undertaken, to revert to the previous hard disk image if required.</p>
<h2 id="related-commands"><a class="toclink" href="#related-commands">Related Commands</a></h2>
<ul>
<li><a href="../Get-ProvSchemeMasterVMImageHistory.html">Get-ProvSchemeMasterVMImageHistory</a></li>
<li><a href="../Get-ProvScheme.html">Get-ProvScheme</a></li>
</ul>
<h2 id="parameters"><a class="toclink" href="#parameters">Parameters</a></h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Required?</th>
<th>Pipeline Input</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>ProvisioningSchemeName</td>
<td>The provisioning scheme to which the hard disk image should be updated.</td>
<td>true</td>
<td>true (ByPropertyName)</td>
<td></td>
</tr>
<tr>
<td>MasterImageVM</td>
<td>The path in the hosting unit provider to the virtual machine snapshot or VM template that will be used.  This identifies the hard disk to be used and the default values for the memory and processors.  This must be a path to a Snapshot or Template item in the hosting unit that the hosting unit name or hosting unit Uid refers to.<br>Valid paths are of the format; XDHyp:\HostingUnits\<HostingUnitName>\<path>\<VMName>.vm\<SnapshotName>.snapshot XDHyp:\HostingUnits\<HostingUnitName>\<path>\<TemplateName>.template</td>
<td>true</td>
<td>true (ByPropertyName)</td>
<td></td>
</tr>
<tr>
<td>ProvisioningSchemeUid</td>
<td>The provisioning scheme identifier to which the hard disk image should be updated.</td>
<td>true</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>VhdTemplateSource</td>
<td>A file path to a source VHD template to be used when performing application scanning during image preparation. The presence of this parameter in conjunction with VhdResultDestination implies that application scanning is to be performed</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>VhdResultDestination</td>
<td>A file path (including file name) where the VHD disk file containing the results of application scanning should be written.</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>AppScanResultsFile</td>
<td>File name to which the results of application scanning should be written.</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>FunctionalLevel</td>
<td>The FunctionalLevel of the VDA installed on the given MasterImageVM.</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>RunAsynchronously</td>
<td>Indicates whether or not the cmdlet should return before it is complete.  If specified, the command returns an identifier for the task that was created.  You can monitor this task using the get-ProvTask cmdlet.</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>PurgeJobOnSuccess</td>
<td>Indicates that the task history will be removed from the database once the task has finished.  This cannot be specified for tasks that are run asynchronously.</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>DoNotStoreOldImage</td>
<td>Specifies that the current image should not be added to the image history list for the provisioning scheme. This is useful when rolling back to a previous image.</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>LoggingId</td>
<td>Specifies the identifier of the high-level operation this cmdlet call forms a part of. Citrix Studio and Director typically create high-level operations. PowerShell scripts can also wrap a series of cmdlet calls in a high-level operation by way of the Start-LogHighLevelOperation and Stop-LogHighLevelOperation cmdlets.</td>
<td>false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>AdminAddress</td>
<td>Specifies the address of a XenDesktop controller the PowerShell snap-in will connect to. You can provide this as a host name or an IP address.</td>
<td>false</td>
<td>false</td>
<td>Localhost. Once a value is provided by any cmdlet, this value becomes the default.</td>
</tr>
</tbody>
</table>
<h2 id="input-type"><a class="toclink" href="#input-type">Input Type</a></h2>
<h3 id="_1"><a class="toclink" href="#_1"></a></h3>
<h2 id="return-values"><a class="toclink" href="#return-values">Return Values</a></h2>
<h3 id="systemguid-when-runasynchronously-is-specified-this-identifier-is-returned-to-provide-the-task-identifiersystemmanagementautomationpscustomobject-this-object-provides-details-of-the-task-run-and-contains-the-following-information-taskid-the-identifier-for-the-task-that-was-performed-active-indicates-whether-the-task-is-still-processing-or-is-complete-host-the-name-of-the-host-on-which-the-task-is-running-or-was-run-datestarted-the-date-and-time-that-the-task-was-initiated-type-the-type-of-the-task-for-new-provisioning-scheme-tasks-this-is-always-newprovisioningscheme-metadata-the-list-of-metadata-stored-against-the-task-for-new-tasks-this-will-be-empty-until-metadata-is-added-workflowstatus-indicates-the-status-of-the-workflow-that-is-being-used-to-process-the-task-provisioningschemename-the-name-of-the-provisioning-scheme-that-the-task-was-for-provisioningschemeuid-the-unique-identifier-of-the-provisioning-scheme-that-the-task-was-for-masterimage-the-path-in-the-hosting-unit-provider-of-the-virtual-machine-snapshot-or-vm-template-that-was-used-as-the-master-image-for-the-task-identitypoolname-the-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-identitypooluid-the-unique-identifier-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunitname-the-name-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunituid-the-unique-identifier-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-taskstate-the-state-of-the-task-this-can-be-any-of-the-following-processing-indicates-that-the-task-has-just-begun-and-has-not-done-anything-yet-locatingresources-indicates-that-the-workflow-is-locating-resources-from-other-services-hostingunitnotfound-indicates-that-the-task-failed-because-the-required-hosting-unit-could-not-be-located-virtualmachinesnapshotnotfound-indicates-that-the-task-failed-because-the-required-snapshot-or-vm-template-could-not-be-located-consolidatingmasterimage-indicates-that-the-task-is-consolidating-the-master-image-replicatingconsolidatedimagetoallstorage-indicates-that-the-task-is-replicating-the-consolidated-master-image-storingprovisioningscheme-indicates-that-the-task-is-storing-the-provisioning-scheme-data-to-the-database-finished-indicates-that-the-task-has-completed-with-no-errors-provisioningschemealreadyexists-indicates-that-the-task-failed-because-a-provisioning-scheme-with-the-same-name-already-exists-identitypoolnotfound-indicates-that-the-task-failed-because-the-identity-pool-specified-could-not-be-found-mastervmimageisnotpartofprovisioningschemehostingunit-indicates-that-the-hosting-unit-that-the-master-image-originated-from-is-not-the-same-hosting-unit-that-the-provisioning-scheme-is-defined-to-use-mastervmimageisnotasnapshot-indicates-that-the-task-failed-because-the-master-vm-image-path-does-not-refer-to-a-snapshot-or-a-vm-template-item-provisioningschemenotfound-could-not-find-a-provisioning-scheme-with-the-specified-name-taskalreadyrunningforprovisioningscheme-a-task-for-a-provisioning-scheme-with-the-same-name-is-already-running-invalidmastervmconfiguration-the-vm-snapshot-or-vm-template-specified-as-the-master-had-an-invalid-configuration-invalidmastervmstate-the-vm-snapshot-or-vm-template-specified-as-the-master-is-currently-in-an-invalid-state-insufficientresources-indicates-that-the-task-failed-because-the-hypervisor-did-not-have-enough-resources-to-complete-the-task-storagenotfound-indicates-that-no-associated-storage-was-found-in-the-hosting-unit-canceled-indicates-that-the-task-was-stopped-by-user-intervention-using-stop-provtask-taskstateinformation-holds-string-data-providing-more-details-about-the-current-task-state-taskprogress-the-progress-of-the-task-0-100"><a class="toclink" href="#systemguid-when-runasynchronously-is-specified-this-identifier-is-returned-to-provide-the-task-identifiersystemmanagementautomationpscustomobject-this-object-provides-details-of-the-task-run-and-contains-the-following-information-taskid-the-identifier-for-the-task-that-was-performed-active-indicates-whether-the-task-is-still-processing-or-is-complete-host-the-name-of-the-host-on-which-the-task-is-running-or-was-run-datestarted-the-date-and-time-that-the-task-was-initiated-type-the-type-of-the-task-for-new-provisioning-scheme-tasks-this-is-always-newprovisioningscheme-metadata-the-list-of-metadata-stored-against-the-task-for-new-tasks-this-will-be-empty-until-metadata-is-added-workflowstatus-indicates-the-status-of-the-workflow-that-is-being-used-to-process-the-task-provisioningschemename-the-name-of-the-provisioning-scheme-that-the-task-was-for-provisioningschemeuid-the-unique-identifier-of-the-provisioning-scheme-that-the-task-was-for-masterimage-the-path-in-the-hosting-unit-provider-of-the-virtual-machine-snapshot-or-vm-template-that-was-used-as-the-master-image-for-the-task-identitypoolname-the-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-identitypooluid-the-unique-identifier-name-of-the-identity-pool-from-the-adidentity-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunitname-the-name-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-hostingunituid-the-unique-identifier-of-the-hosting-unit-from-the-hosting-unit-powershell-snap-in-that-the-new-provisioning-scheme-will-use-taskstate-the-state-of-the-task-this-can-be-any-of-the-following-processing-indicates-that-the-task-has-just-begun-and-has-not-done-anything-yet-locatingresources-indicates-that-the-workflow-is-locating-resources-from-other-services-hostingunitnotfound-indicates-that-the-task-failed-because-the-required-hosting-unit-could-not-be-located-virtualmachinesnapshotnotfound-indicates-that-the-task-failed-because-the-required-snapshot-or-vm-template-could-not-be-located-consolidatingmasterimage-indicates-that-the-task-is-consolidating-the-master-image-replicatingconsolidatedimagetoallstorage-indicates-that-the-task-is-replicating-the-consolidated-master-image-storingprovisioningscheme-indicates-that-the-task-is-storing-the-provisioning-scheme-data-to-the-database-finished-indicates-that-the-task-has-completed-with-no-errors-provisioningschemealreadyexists-indicates-that-the-task-failed-because-a-provisioning-scheme-with-the-same-name-already-exists-identitypoolnotfound-indicates-that-the-task-failed-because-the-identity-pool-specified-could-not-be-found-mastervmimageisnotpartofprovisioningschemehostingunit-indicates-that-the-hosting-unit-that-the-master-image-originated-from-is-not-the-same-hosting-unit-that-the-provisioning-scheme-is-defined-to-use-mastervmimageisnotasnapshot-indicates-that-the-task-failed-because-the-master-vm-image-path-does-not-refer-to-a-snapshot-or-a-vm-template-item-provisioningschemenotfound-could-not-find-a-provisioning-scheme-with-the-specified-name-taskalreadyrunningforprovisioningscheme-a-task-for-a-provisioning-scheme-with-the-same-name-is-already-running-invalidmastervmconfiguration-the-vm-snapshot-or-vm-template-specified-as-the-master-had-an-invalid-configuration-invalidmastervmstate-the-vm-snapshot-or-vm-template-specified-as-the-master-is-currently-in-an-invalid-state-insufficientresources-indicates-that-the-task-failed-because-the-hypervisor-did-not-have-enough-resources-to-complete-the-task-storagenotfound-indicates-that-no-associated-storage-was-found-in-the-hosting-unit-canceled-indicates-that-the-task-was-stopped-by-user-intervention-using-stop-provtask-taskstateinformation-holds-string-data-providing-more-details-about-the-current-task-state-taskprogress-the-progress-of-the-task-0-100">System.Guid<br>    When "RunAsynchronously" is specified, this identifier is returned to provide the task identifier.<br>System.Management.Automation.PSCustomObject<br>    This object provides details of the task run and contains the following information:<br>        TaskId <Guid><br>            The identifier for the task that was performed.<br>        Active <Boolean><br>            Indicates whether the task is still processing or is complete.<br>        Host <string><br>            The name of the host on which the task is running or was run.<br>        DateStarted <DateTime><br>            The date and time that the task was initiated.<br>        Type <Citrix.XDInterServiceTypes.JobType><br>            The type of the task.  For new provisioning scheme tasks this is always "NewProvisioningScheme".<br>        Metadata <Citrix.MachineCreation.Sdk.Metadata[]><br>            The list of metadata stored against the task.  For new tasks this will be empty until metadata is added.<br>        WorkflowStatus <System.Workflow.Runtime.WorkflowStatus><br>            Indicates the status of the workflow that is being used to process the task.<br>        ProvisioningSchemeName <string><br>            The name of the provisioning scheme that the task was for.<br>        ProvisioningSchemeUid <Guid><br>            The unique identifier of the provisioning scheme that the task was for.<br>        MasterImage <string><br>            The path (in the hosting unit provider) of the virtual machine snapshot or VM template that was used as the master image for the task.<br>        IdentityPoolName <string><br>            The name of the identity pool (from the ADIdentity PowerShell snap-in) that the new provisioning scheme will use.<br>        IdentityPoolUid <guid><br>            The unique identifier name of the identity pool (from the ADIdentity PowerShell snap-in) that the new provisioning scheme will use.<br>        HostingUnitName <string><br>            The name of the hosting unit (from the Hosting Unit PowerShell snap-in) that the new provisioning scheme will use.<br>        HostingUnitUid<br>            The unique identifier of the hosting unit (from the Hosting Unit PowerShell snap-in) that the new provisioning scheme will use.<br>        TaskState <Citrix.DesktopUpdateManager.SDK.NewProvisioningSchemeState><br>            The state of the task.  This can be any of the following:<br>                Processing<br>                    Indicates that the task has just begun and has not done anything yet.<br>                LocatingResources,<br>                    Indicates that the workflow is locating resources from other services.<br>                HostingUnitNotFound<br>                    Indicates that the task failed because the required hosting unit could not be located.<br>                VirtualMachineSnapshotNotFound<br>                    Indicates that the task failed because the required snapshot or VM template could not be located.<br>                ConsolidatingMasterImage<br>                    Indicates that the task is consolidating the master image.<br>                ReplicatingConsolidatedImageToAllStorage<br>                    Indicates that the task is replicating the consolidated master image.<br>                StoringProvisioningScheme<br>                    Indicates that the task is storing the provisioning scheme data to the database.<br>                Finished<br>                    Indicates that the task has completed with no errors.<br>                ProvisioningSchemeAlreadyExists<br>                    Indicates that the task failed because a provisioning scheme with the same name already exists.<br>                IdentityPoolNotFound<br>                    Indicates that the task failed because the identity pool specified could not be found.<br>                MasterVMImageIsNotPartOfProvisioningSchemeHostingUnit,<br>                    Indicates that the hosting unit that the master image originated from is not the same hosting unit that the provisioning scheme is defined to use.<br>                MasterVmImageIsNotASnapshot<br>                    Indicates that the task failed because the master VM image path does not refer to a snapshot or a VM template item.<br>                ProvisioningSchemeNotFound<br>                    Could not find a provisioning scheme with the specified name.<br>                TaskAlreadyRunningForProvisioningScheme<br>                    A task for a provisioning scheme with the same name is already running.<br>                InvalidMasterVMConfiguration<br>                    The VM snapshot or VM template specified as the master had an invalid configuration.<br>                InvalidMasterVMState<br>                    The VM snapshot or VM template specified as the master is currently in an invalid state.<br>                InsufficientResources<br>                    Indicates that the task failed because the hypervisor did not have enough resources to complete the task.<br>                StorageNotFound<br>                    Indicates that no associated storage was found in the hosting unit.<br>                Canceled<br>                    Indicates that the task was stopped by user intervention (using Stop-ProvTask).<br>        TaskStateInformation <string><br>            Holds string data providing more details about the current task state.<br>        TaskProgress<br>            The progress of the task 0-100%.</a></h3>
<p>## Notes
   Only one long-running task per provisioning scheme can be processed at any one time.<br>    In the case of failure, the following errors can result.<br>    Error Codes<br>    -----------<br>    JobCreationFailed<br>    The requested task could not be started.<br>    DatabaseError<br>    An error occurred in the service while attempting a database operation.<br>    DatabaseNotConfigured<br>    The operation could not be completed because the database for the service is not configured.<br>    ServiceStatusInvalidDb<br>    An error occurred in the service while attempting a database operation - communication with the database failed for<br>    for various reasons.<br>    WorkflowHostUnavailable<br>    The task could not be started because the database connection is inactive.<br>    CommunicationError<br>    An error occurred while communicating with the service.<br>    PermissionDenied<br>    The user does not have administrative rights to perform this operation.<br>    ConfigurationLoggingError<br>    The operation could not be performed because of a configuration logging error.<br>    ExceptionThrown<br>    An unexpected error occurred.  To locate more details, see the Windows event logs on the controller being used or examine the XenDesktop logs.<br>    The cmdlet is associated with a task of type PublishImage, and while active will move through the following operations (CurrentOperation field)<br>    ValidatingInputs<br>    ConsolidatingMasterImage<br>    PreparingMasterImage<br>    ReplicatingMasterImage<br>    CommittingScheme</p>
<h2 id="examples"><a class="toclink" href="#examples">Examples</a></h2>
<h3 id="example-1"><a class="toclink" href="#example-1">EXAMPLE 1</a></h3>
<div class="codehilite"><pre><span></span>c:\PS&gt;Publish-ProvMasterVMImage -ProvisioningSchemeName MyScheme -MasterImageVM XDHyp:\H
stingUnits\HostUnit1\RhoneCC_baseXP.vm\base.snapshot

TaskId                 : 248f102f-073f-45fe-aea9-1819a6d6dd1f
Active                 : False
Host                   : MyHost
DateStarted            : 17/05/2010 17:37:57
Type                   : PublishImage
Metadata               : {}
WorkflowStatus         : Completed
ProvisioningSchemeUid  : 7585f0de-192e-4847-a6d8-22713c3a2f42
ProvisioningSchemeName : MyScheme
MasterImage            : /RhoneCC_baseXP.vm/base.snapshot
HostingUnitName        : HostUnit1
HostingUnitUid         : 01a4a008-8ce8-4165-ba9c-cdf15a6b0501
ADIdentityPoolName     :
ADIdentityPoolUid      : 03743136-e43b-4a87-af74-ab71686b3c16
CurrentOperation       :
TaskState              : Finished
TaskStateInformation   :
</pre></div>


<p>Description<br>-----------<br>Updates the master hard disk image for the provisioning Scheme "MyScheme" to use the "base.snapshot" hard disk image.</p>
              

            </div>
          </div>

        </div>
      </div>

    </section>

  </div>

<!--<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span class="prev"><a href="../New-ProvVM/"><i class="fa fa-angle-left"></i> Previous</a></span>
      
      
        <span class="next"><a href="../Remove-ProvScheme/">Next <i class="fa fa-angle-right"></i></a></span>
      
    </span>
	<div class="footer-right">
		<ul class="social-links">
			<li class="list-inline"><a href="https://twitter.com/citrix"><i class="fa fa-twitter"></i>@citrix</a></li>
			<li class="list-inline"><a href="mailto:support@citrix.com"><i class="fa fa-envelope-o"></i>support@citrix.com</a></li>
		</ul>
		<ul class="inner-pages">
			<li class="list-inline"><a href="http://citrix.com/about/legal">Privacy and Terms</li>
		</ul>
	</div>
</div>-->

</body>
</html>
